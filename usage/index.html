<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AIT-CATMA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js"></script>

</head>
<nav class="navbar is-dark">
    <div class="navbar-brand">
        <a class="navbar-item brand-text" href="">
            <image src="logo.png">
        </a>
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
    </div>
    <div id="navMenu" class="navbar-menu">
        <div class="navbar-start">
            <a class="navbar-item" href="index.html">
                Monitor
            </a>
        </div>
    </div>
</nav>

<body>
<section class="section">
    <div class="container">
        <div class="columns">
            <div class="column is-4">
                <h1 class="title">Hello SNMP at
                    <span style="color: #ff6600">CAT</span>
                    <span style="color: #55595d">MA</span>
                </h1>
                <p class="subtitle">my first website with
                    <strong>Bulma</strong>!</strong>
                </p>
                <hr class="hr" style="margin-top: 0">
                <form method="POST" action="test-back.py">
                    <div class="field">
                        <label class="label">
                            Fill ip address of router that you want to monitor.
                        </label>
                        <div class="field is-grouped">
                            <div class="control is-expanded">
                                <input name="ipaddress" class="input is-rounded" type="text"
                                       placeholder="eg. 192.168.10.1" id="ipaddress"/>
                            </div>
                            <a class="button is-link is-outlined" id="btn_AddToList">
                                Add
                            </a>
                        </div>
                        <div id="ipList"></div>
                    </div>
                    <div class="field">
                        <label class="label">
                            Fill community string of router that you want to monitor.
                        </label>
                        <div class="field is-grouped">
                            <div class="control is-expanded">
                                <input name="community" class="input is-rounded" type="text" placeholder="eg. public"
                                       id="community"/>
                            </div>
                        </div>
                    </div>

                    <div class="field">
                        <label class="label">
                            Fill oid in MIB-II that you want to monitor.
                        </label>
                        <div class="control">
                            <input name="oid" class="input is-rounded" type="text" placeholder="eg. 1.3.6.1.2.1.1.1"
                                   id="oid"/>
                        </div>
                    </div>

                    <div class="field is-grouped is-grouped-centered">
                        <div class="select is-link">
                            <select name="droplist" id="droplist">
                                <option>Select dropdown</option>
                                <option value="system">System</option>
                                <option value="interface">Interface</option>
                                <option value="snmp">SNMP</option>
                                <option value="icmp">ICMP</option>
                                <option value="udp">UDP</option>
                            </select>
                        </div>
                    </div>
                    <hr class="hr">
                    <div class="field is-grouped is-grouped-centered">
                        <p class="control">
                            <a class="button is-link" id="send">
                                Submit
                            </a>
                        </p>
                        <p class="control">
                            <a class="button is-light">
                                Cancel
                            </a>
                        </p>
                    </div>
                </form>
            </div>
            <div class="column is-1">
                <hr style="width: 1px; height: 80%">
            </div>
            <div class="column is-8" id="table"></div>
        </div>
    </div>
</section>
</body>
<script>
    var ipList = [];

    $(document).ready(function () {
        $('#btn_AddToList').click(function () {
            var val = $('#ipaddress').val();
            ipList.push(val);
            // $('#ipList').html(list);
            document.getElementById("ipList").innerHTML = ipList;
            document.getElementById('ipaddress').value = '';
            // $('#txt_RegionName').val('').focus();
        })
    });

    $(document).ready(function () {
        $("#send").on('click', function () {

            setInterval(function () {
                // var ipaddress = $("#ipaddress").val();
                if (ipList === undefined || ipList.length == 0) {
                    ipList.push($("#ipaddress").val());
                }
                console.log(ipList);
                var droplist = $("#droplist").val();        // unused
                var community = $("#community").val();
                if (community === "") {
                    community = "public";
                }
                $.ajax({
                    url: 'test.py',
                    type: 'post',
                    data: {
                        'ipList': JSON.stringify(ipList),
                        'community': community,
                        'droplist': droplist
                    },
                    success: function (response) {
                        console.log(ipList);
                        $("#table").html(response);
                    }, error: function (request, ajaxOptions, thrownError) {
                        $("#table").html(request.responseText);
                    }
                });

            }, 3000);

        });
    });
</script>
</html>

